// -*- c++ -*-
//==============================================================================
// IRIS - Long-range Interaction Solver Library
//
// Copyright (c) 2017-2021, the National Center for Supercomputing Applications
//
// Primary authors:
//     Valentin Pavlov <vpavlov@rila.bg>
//     Peicho Petkov <peicho@phys.uni-sofia.bg>
//     Stoyan Markov <markov@acad.bg>
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
//==============================================================================
#include "cuda.h"
#include "real.h"
#include "fmm.h"
#include "fmm_swapxz.h"

#define DEF_SWAP_XZ(FN_NAME, FNARR_NAME)				\
    void FN_NAME(iris_real *mult, int p)				\
    {									\
        iris_real tmp[(IRIS_FMM_MAX_ORDER+1)*(IRIS_FMM_MAX_ORDER+1)];	\
									\
	for(int i=1;i<=p;i++) {						\
	    iris_real *src = mult + i*i;				\
	    int cnt = 2*i + 1;						\
	    FNARR_NAME[i-1](tmp, src);					\
	    memcpy(src, tmp, cnt * sizeof(iris_real));			\
	}								\
    }

DEF_SWAP_XZ(swapT_xz, swapT_fns);
DEF_SWAP_XZ(swap_xz, swap_fns);

#ifdef IRIS_CUDA
IRIS_CUDA_DEVICE DEF_SWAP_XZ(d_swapT_xz, d_swapT_fns);
IRIS_CUDA_DEVICE DEF_SWAP_XZ(d_swap_xz, d_swap_fns);
#endif

// NOTE NOTE NOTE
// THIS BLOCK BELOW IS AUTOMATICALLY GENERATED
//
//---------------8<---------------8<----------------8<---------------


//////////////////////
// Swap XZ @ order 1
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz1(iris_real *D, iris_real *S) {
  D[0] = S[0] * 1.    ;
  D[1] = S[2] * 1.    ;
  D[2] = S[1] * 1.    ;
}

//////////////////////
// SwapT XZ @ order 1
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz1(iris_real *D, iris_real *S) {
  D[0] = S[0] * 1.    ;
  D[1] = S[2] * 2.    ;
  D[2] = S[1] * 0.5    ;
}

//////////////////////
// Swap XZ @ order 2
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz2(iris_real *D, iris_real *S) {
  D[0] = S[1] * 2.    ;
  D[1] = S[0] * 0.5    ;
  D[2] = S[2] * -0.5     + S[4] * 0.5    ;
  D[3] = S[3] * 1.    ;
  D[4] = S[2] * 1.5     + S[4] * 0.5    ;
}

//////////////////////
// SwapT XZ @ order 2
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz2(iris_real *D, iris_real *S) {
  D[0] = S[1] * 0.5    ;
  D[1] = S[0] * 2.    ;
  D[2] = S[2] * -0.5     + S[4] * 3.    ;
  D[3] = S[3] * 1.    ;
  D[4] = S[2] * 0.25     + S[4] * 0.5    ;
}

//////////////////////
// Swap XZ @ order 3
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz3(iris_real *D, iris_real *S) {
  D[0] = S[0] * 0.25     + S[2] * 3.75    ;
  D[1] = S[1] * 1.    ;
  D[2] = S[0] * 0.25     + S[2] * -0.25    ;
  D[3] = S[4] * -0.75     + S[6] * 0.25    ;
  D[4] = S[3] * -0.5     + S[5] * 0.5    ;
  D[5] = S[4] * 1.25     + S[6] * 0.25    ;
  D[6] = S[3] * 2.5     + S[5] * 1.5    ;
}

//////////////////////
// SwapT XZ @ order 3
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz3(iris_real *D, iris_real *S) {
  D[0] = S[0] * 0.25     + S[2] * 0.25    ;
  D[1] = S[1] * 1.    ;
  D[2] = S[0] * 3.75     + S[2] * -0.25    ;
  D[3] = S[4] * -1.     + S[6] * 5.    ;
  D[4] = S[3] * -0.375     + S[5] * 1.25    ;
  D[5] = S[4] * 0.5     + S[6] * 1.5    ;
  D[6] = S[3] * 0.125     + S[5] * 0.25    ;
}

//////////////////////
// Swap XZ @ order 4
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz4(iris_real *D, iris_real *S) {
  D[0] = S[1] * 1.     + S[3] * 7.    ;
  D[1] = S[0] * 0.125     + S[2] * 1.75    ;
  D[2] = S[1] * 0.5     + S[3] * -0.5    ;
  D[3] = S[0] * 0.125     + S[2] * -0.25    ;
  D[4] = S[4] * 0.375     + S[6] * -0.5     + S[8] * 0.125    ;
  D[5] = S[5] * -0.75     + S[7] * 0.25    ;
  D[6] = S[4] * -0.625     + S[6] * 0.5     + S[8] * 0.125    ;
  D[7] = S[5] * 1.75     + S[7] * 0.75    ;
  D[8] = S[4] * 4.375     + S[6] * 3.5     + S[8] * 0.125    ;
}

//////////////////////
// SwapT XZ @ order 4
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz4(iris_real *D, iris_real *S) {
  D[0] = S[1] * 0.125     + S[3] * 0.125    ;
  D[1] = S[0] * 1.     + S[2] * 0.5    ;
  D[2] = S[1] * 1.75     + S[3] * -0.25    ;
  D[3] = S[0] * 7.     + S[2] * -0.5    ;
  D[4] = S[4] * 0.375     + S[6] * -1.25     + S[8] * 8.75    ;
  D[5] = S[5] * -0.75     + S[7] * 1.75    ;
  D[6] = S[4] * -0.25     + S[6] * 0.5     + S[8] * 3.5    ;
  D[7] = S[5] * 0.25     + S[7] * 0.75    ;
  D[8] = S[4] * 6.2500e-2 + S[6] * 0.125     + S[8] * 0.125    ;
}

//////////////////////
// Swap XZ @ order 5
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz5(iris_real *D, iris_real *S) {
  D[0] = S[0] * 6.2500e-2 + S[2] * 2.8125     + S[4] * 13.125    ;
  D[1] = S[1] * 0.5     + S[3] * 3.    ;
  D[2] = S[0] * 6.2500e-2 + S[2] * 0.8125     + S[4] * -0.875    ;
  D[3] = S[1] * 0.25     + S[3] * -0.5    ;
  D[4] = S[0] * 6.2500e-2 + S[2] * -0.1875     + S[4] * 0.125    ;
  D[5] = S[6] * 0.625     + S[8] * -0.3125     + S[10] * 6.2500e-2;
  D[6] = S[5] * 0.375     + S[7] * -0.5     + S[9] * 0.125    ;
  D[7] = S[6] * -0.875     + S[8] * 0.1875     + S[10] * 6.2500e-2;
  D[8] = S[5] * -0.875     + S[7] * 0.5     + S[9] * 0.375    ;
  D[9] = S[6] * 2.625     + S[8] * 1.6875     + S[10] * 6.2500e-2;
  D[10] = S[5] * 7.875     + S[7] * 7.5     + S[9] * 0.625    ;
}

//////////////////////
// SwapT XZ @ order 5
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz5(iris_real *D, iris_real *S) {
  D[0] = S[0] * 6.2500e-2 + S[2] * 6.2500e-2 + S[4] * 6.2500e-2;
  D[1] = S[1] * 0.5     + S[3] * 0.25    ;
  D[2] = S[0] * 2.8125     + S[2] * 0.8125     + S[4] * -0.1875    ;
  D[3] = S[1] * 3.     + S[3] * -0.5    ;
  D[4] = S[0] * 13.125     + S[2] * -0.875     + S[4] * 0.125    ;
  D[5] = S[6] * 0.75     + S[8] * -1.75     + S[10] * 15.75    ;
  D[6] = S[5] * 0.3125     + S[7] * -0.875     + S[9] * 2.625    ;
  D[7] = S[6] * -0.5     + S[8] * 0.5     + S[10] * 7.5    ;
  D[8] = S[5] * -0.15625     + S[7] * 0.1875     + S[9] * 1.6875    ;
  D[9] = S[6] * 0.125     + S[8] * 0.375     + S[10] * 0.625    ;
  D[10] = S[5] * 3.12500e-2 + S[7] * 6.2500e-2 + S[9] * 6.2500e-2;
}

//////////////////////
// Swap XZ @ order 6
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz6(iris_real *D, iris_real *S) {
  D[0] = S[1] * 0.375     + S[3] * 6.875     + S[5] * 24.75    ;
  D[1] = S[0] * 3.12500e-2 + S[2] * 1.375     + S[4] * 5.15625    ;
  D[2] = S[1] * 0.25     + S[3] * 1.25     + S[5] * -1.5    ;
  D[3] = S[0] * 3.12500e-2 + S[2] * 0.375     + S[4] * -0.84375    ;
  D[4] = S[1] * 0.125     + S[3] * -0.375     + S[5] * 0.25    ;
  D[5] = S[0] * 3.12500e-2 + S[2] * -0.125     + S[4] * 0.15625    ;
  D[6] = S[6] * -0.3125     + S[8] * 0.46875     + S[10] * -0.1875     + S[12] * 3.12500e-2;
  D[7] = S[7] * 0.625     + S[9] * -0.3125     + S[11] * 6.2500e-2;
  D[8] = S[6] * 0.4375     + S[8] * -0.53125     + S[10] * 6.2500e-2 + S[12] * 3.12500e-2;
  D[9] = S[7] * -1.125     + S[9] * 6.2500e-2 + S[11] * 0.1875    ;
  D[10] = S[6] * -1.3125     + S[8] * 0.46875     + S[10] * 0.8125     + S[12] * 3.12500e-2;
  D[11] = S[7] * 4.125     + S[9] * 3.4375     + S[11] * 0.3125    ;
  D[12] = S[6] * 14.4375     + S[8] * 15.46875     + S[10] * 2.0625     + S[12] * 3.12500e-2;
}

//////////////////////
// SwapT XZ @ order 6
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz6(iris_real *D, iris_real *S) {
  D[0] = S[1] * 3.12500e-2 + S[3] * 3.12500e-2 + S[5] * 3.12500e-2;
  D[1] = S[0] * 0.375     + S[2] * 0.25     + S[4] * 0.125    ;
  D[2] = S[1] * 1.375     + S[3] * 0.375     + S[5] * -0.125    ;
  D[3] = S[0] * 6.875     + S[2] * 1.25     + S[4] * -0.375    ;
  D[4] = S[1] * 5.15625     + S[3] * -0.84375     + S[5] * 0.15625    ;
  D[5] = S[0] * 24.75     + S[2] * -1.5     + S[4] * 0.25    ;
  D[6] = S[6] * -0.3125     + S[8] * 0.875     + S[10] * -2.625     + S[12] * 28.875    ;
  D[7] = S[7] * 0.625     + S[9] * -1.125     + S[11] * 4.125    ;
  D[8] = S[6] * 0.234375     + S[8] * -0.53125     + S[10] * 0.46875     + S[12] * 15.46875    ;
  D[9] = S[7] * -0.3125     + S[9] * 6.2500e-2 + S[11] * 3.4375    ;
  D[10] = S[6] * -9.37500e-2 + S[8] * 6.2500e-2 + S[10] * 0.8125     + S[12] * 2.0625    ;
  D[11] = S[7] * 6.2500e-2 + S[9] * 0.1875     + S[11] * 0.3125    ;
  D[12] = S[6] * 1.562500e-2 + S[8] * 3.12500e-2 + S[10] * 3.12500e-2 + S[12] * 3.12500e-2;
}

//////////////////////
// Swap XZ @ order 7
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz7(iris_real *D, iris_real *S) {
  D[0] = S[0] * 1.562500e-2 + S[2] * 1.421875     + S[4] * 15.640625     + S[6] * 46.921875    ;
  D[1] = S[1] * 0.1875     + S[3] * 3.25     + S[5] * 8.9375    ;
  D[2] = S[0] * 1.562500e-2 + S[2] * 0.671875     + S[4] * 1.890625     + S[6] * -2.578125    ;
  D[3] = S[1] * 0.125     + S[3] * 0.5     + S[5] * -1.375    ;
  D[4] = S[0] * 1.562500e-2 + S[2] * 0.171875     + S[4] * -0.609375     + S[6] * 0.421875    ;
  D[5] = S[1] * 6.2500e-2 + S[3] * -0.25     + S[5] * 0.3125    ;
  D[6] = S[0] * 1.562500e-2 + S[2] * -7.812500e-2 + S[4] * 0.140625     + S[6] * -7.812500e-2;
  D[7] = S[8] * -0.546875     + S[10] * 0.328125     + S[12] * -0.109375     + S[14] * 1.562500e-2;
  D[8] = S[7] * -0.3125     + S[9] * 0.46875     + S[11] * -0.1875     + S[13] * 3.12500e-2;
  D[9] = S[8] * 0.703125     + S[10] * -0.296875     + S[12] * 1.562500e-2 + S[14] * 1.562500e-2;
  D[10] = S[7] * 0.5625     + S[9] * -0.59375     + S[11] * -6.2500e-2 + S[13] * 9.37500e-2;
  D[11] = S[8] * -1.546875     + S[10] * -0.171875     + S[12] * 0.390625     + S[14] * 1.562500e-2;
  D[12] = S[7] * -2.0625     + S[9] * 0.34375     + S[11] * 1.5625     + S[13] * 0.15625    ;
  D[13] = S[8] * 6.703125     + S[10] * 6.703125     + S[12] * 1.015625     + S[14] * 1.562500e-2;
  D[14] = S[7] * 26.8125     + S[9] * 31.28125     + S[11] * 5.6875     + S[13] * 0.21875    ;
}

//////////////////////
// SwapT XZ @ order 7
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz7(iris_real *D, iris_real *S) {
  D[0] = S[0] * 1.562500e-2 + S[2] * 1.562500e-2 + S[4] * 1.562500e-2 + S[6] * 1.562500e-2;
  D[1] = S[1] * 0.1875     + S[3] * 0.125     + S[5] * 6.2500e-2;
  D[2] = S[0] * 1.421875     + S[2] * 0.671875     + S[4] * 0.171875     + S[6] * -7.812500e-2;
  D[3] = S[1] * 3.25     + S[3] * 0.5     + S[5] * -0.25    ;
  D[4] = S[0] * 15.640625     + S[2] * 1.890625     + S[4] * -0.609375     + S[6] * 0.140625    ;
  D[5] = S[1] * 8.9375     + S[3] * -1.375     + S[5] * 0.3125    ;
  D[6] = S[0] * 46.921875     + S[2] * -2.578125     + S[4] * 0.421875     + S[6] * -7.812500e-2;
  D[7] = S[8] * -0.625     + S[10] * 1.125     + S[12] * -4.125     + S[14] * 53.625    ;
  D[8] = S[7] * -0.2734375     + S[9] * 0.703125     + S[11] * -1.546875     + S[13] * 6.703125    ;
  D[9] = S[8] * 0.46875     + S[10] * -0.59375     + S[12] * 0.34375     + S[14] * 31.28125    ;
  D[10] = S[7] * 0.1640625     + S[9] * -0.296875     + S[11] * -0.171875     + S[13] * 6.703125    ;
  D[11] = S[8] * -0.1875     + S[10] * -6.2500e-2 + S[12] * 1.5625     + S[14] * 5.6875    ;
  D[12] = S[7] * -5.4687500e-2 + S[9] * 1.562500e-2 + S[11] * 0.390625     + S[13] * 1.015625    ;
  D[13] = S[8] * 3.12500e-2 + S[10] * 9.37500e-2 + S[12] * 0.15625     + S[14] * 0.21875    ;
  D[14] = S[7] * 7.8125000e-3 + S[9] * 1.562500e-2 + S[11] * 1.562500e-2 + S[13] * 1.562500e-2;
}

//////////////////////
// Swap XZ @ order 8
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz8(iris_real *D, iris_real *S) {
  D[0] = S[1] * 0.125     + S[3] * 4.375     + S[5] * 34.125     + S[7] * 89.375    ;
  D[1] = S[0] * 7.8125000e-3 + S[2] * 0.703125     + S[4] * 7.109375     + S[6] * 15.640625    ;
  D[2] = S[1] * 9.37500e-2 + S[3] * 1.53125     + S[5] * 2.84375     + S[7] * -4.46875    ;
  D[3] = S[0] * 7.8125000e-3 + S[2] * 0.328125     + S[4] * 0.609375     + S[6] * -2.234375    ;
  D[4] = S[1] * 6.2500e-2 + S[3] * 0.1875     + S[5] * -0.9375     + S[7] * 0.6875    ;
  D[5] = S[0] * 7.8125000e-3 + S[2] * 7.812500e-2 + S[4] * -0.390625     + S[6] * 0.515625    ;
  D[6] = S[1] * 3.12500e-2 + S[3] * -0.15625     + S[5] * 0.28125     + S[7] * -0.15625    ;
  D[7] = S[0] * 7.8125000e-3 + S[2] * -4.687500e-2 + S[4] * 0.109375     + S[6] * -0.109375    ;
  D[8] = S[8] * 0.2734375     + S[10] * -0.4375     + S[12] * 0.21875     + S[14] * -6.2500e-2 + S[16] * 7.8125000e-3;
  D[9] = S[9] * -0.546875     + S[11] * 0.328125     + S[13] * -0.109375     + S[15] * 1.562500e-2;
  D[10] = S[8] * -0.3515625     + S[10] * 0.5     + S[12] * -0.15625     + S[16] * 7.8125000e-3;
  D[11] = S[9] * 0.859375     + S[11] * -0.265625     + S[13] * -7.812500e-2 + S[15] * 4.687500e-2;
  D[12] = S[8] * 0.7734375     + S[10] * -0.6875     + S[12] * -0.28125     + S[14] * 0.1875     + S[16] * 7.8125000e-3;
  D[13] = S[9] * -2.234375     + S[11] * -0.609375     + S[13] * 0.703125     + S[15] * 7.812500e-2;
  D[14] = S[8] * -3.3515625     + S[12] * 2.84375     + S[14] * 0.5     + S[16] * 7.8125000e-3;
  D[15] = S[9] * 11.171875     + S[11] * 12.796875     + S[13] * 2.734375     + S[15] * 0.109375    ;
  D[16] = S[8] * 50.2734375     + S[10] * 62.5625     + S[12] * 14.21875     + S[14] * 0.9375     + S[16] * 7.8125000e-3;
}

//////////////////////
// SwapT XZ @ order 8
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz8(iris_real *D, iris_real *S) {
  D[0] = S[1] * 7.8125000e-3 + S[3] * 7.8125000e-3 + S[5] * 7.8125000e-3 + S[7] * 7.8125000e-3;
  D[1] = S[0] * 0.125     + S[2] * 9.37500e-2 + S[4] * 6.2500e-2 + S[6] * 3.12500e-2;
  D[2] = S[1] * 0.703125     + S[3] * 0.328125     + S[5] * 7.812500e-2 + S[7] * -4.687500e-2;
  D[3] = S[0] * 4.375     + S[2] * 1.53125     + S[4] * 0.1875     + S[6] * -0.15625    ;
  D[4] = S[1] * 7.109375     + S[3] * 0.609375     + S[5] * -0.390625     + S[7] * 0.109375    ;
  D[5] = S[0] * 34.125     + S[2] * 2.84375     + S[4] * -0.9375     + S[6] * 0.28125    ;
  D[6] = S[1] * 15.640625     + S[3] * -2.234375     + S[5] * 0.515625     + S[7] * -0.109375    ;
  D[7] = S[0] * 89.375     + S[2] * -4.46875     + S[4] * 0.6875     + S[6] * -0.15625    ;
  D[8] = S[8] * 0.2734375     + S[10] * -0.703125     + S[12] * 1.546875     + S[14] * -6.703125     + S[16] * 100.546875    ;
  D[9] = S[9] * -0.546875     + S[11] * 0.859375     + S[13] * -2.234375     + S[15] * 11.171875    ;
  D[10] = S[8] * -0.21875     + S[10] * 0.5     + S[12] * -0.6875     + S[16] * 62.5625    ;
  D[11] = S[9] * 0.328125     + S[11] * -0.265625     + S[13] * -0.609375     + S[15] * 12.796875    ;
  D[12] = S[8] * 0.109375     + S[10] * -0.15625     + S[12] * -0.28125     + S[14] * 2.84375     + S[16] * 14.21875    ;
  D[13] = S[9] * -0.109375     + S[11] * -7.812500e-2 + S[13] * 0.703125     + S[15] * 2.734375    ;
  D[14] = S[8] * -3.12500e-2 + S[12] * 0.1875     + S[14] * 0.5     + S[16] * 0.9375    ;
  D[15] = S[9] * 1.562500e-2 + S[11] * 4.687500e-2 + S[13] * 7.812500e-2 + S[15] * 0.109375    ;
  D[16] = S[8] * 3.90625000e-3 + S[10] * 7.8125000e-3 + S[12] * 7.8125000e-3 + S[14] * 7.8125000e-3 + S[16] * 7.8125000e-3;
}

//////////////////////
// Swap XZ @ order 9
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz9(iris_real *D, iris_real *S) {
  D[0] = S[0] * 3.90625000e-3 + S[2] * 0.59765625     + S[4] * 11.953125     + S[6] * 72.515625     + S[8] * 170.9296875    ;
  D[1] = S[1] * 6.2500e-2 + S[3] * 2.125     + S[5] * 14.875     + S[7] * 27.625    ;
  D[2] = S[0] * 3.90625000e-3 + S[2] * 0.34765625     + S[4] * 3.203125     + S[6] * 4.265625     + S[8] * -7.8203125    ;
  D[3] = S[1] * 4.687500e-2 + S[3] * 0.71875     + S[5] * 0.65625     + S[7] * -3.65625    ;
  D[4] = S[0] * 3.90625000e-3 + S[2] * 0.16015625     + S[4] * 0.140625     + S[6] * -1.421875     + S[8] * 1.1171875    ;
  D[5] = S[1] * 3.12500e-2 + S[3] * 6.2500e-2 + S[5] * -0.5625     + S[7] * 0.8125    ;
  D[6] = S[0] * 3.90625000e-3 + S[2] * 3.51562500e-2 + S[4] * -0.234375     + S[6] * 0.453125     + S[8] * -0.2578125    ;
  D[7] = S[1] * 1.562500e-2 + S[3] * -9.37500e-2 + S[5] * 0.21875     + S[7] * -0.21875    ;
  D[8] = S[0] * 3.90625000e-3 + S[2] * -2.73437500e-2 + S[4] * 7.812500e-2 + S[6] * -0.109375     + S[8] * 5.4687500e-2;
  D[9] = S[10] * 0.4921875     + S[12] * -0.328125     + S[14] * 0.140625     + S[16] * -3.51562500e-2 + S[18] * 3.90625000e-3;
  D[10] = S[9] * 0.2734375     + S[11] * -0.4375     + S[13] * 0.21875     + S[15] * -6.2500e-2 + S[17] * 7.8125000e-3;
  D[11] = S[10] * -0.6015625     + S[12] * 0.328125     + S[14] * -7.812500e-2 + S[16] * -3.90625000e-3 + S[18] * 3.90625000e-3;
  D[12] = S[9] * -0.4296875     + S[11] * 0.5625     + S[13] * -9.37500e-2 + S[15] * -6.2500e-2 + S[17] * 2.3437500e-2;
  D[13] = S[10] * 1.1171875     + S[12] * -0.203125     + S[14] * -0.234375     + S[16] * 8.98437500e-2 + S[18] * 3.90625000e-3;
  D[14] = S[9] * 1.1171875     + S[11] * -0.8125     + S[13] * -0.65625     + S[15] * 0.3125     + S[17] * 3.9062500e-2;
  D[15] = S[10] * -3.3515625     + S[12] * -1.421875     + S[14] * 1.171875     + S[16] * 0.24609375     + S[18] * 3.90625000e-3;
  D[16] = S[9] * -5.5859375     + S[11] * -0.8125     + S[13] * 5.03125     + S[15] * 1.3125     + S[17] * 5.4687500e-2;
  D[17] = S[10] * 18.9921875     + S[12] * 24.171875     + S[14] * 6.640625     + S[16] * 0.46484375     + S[18] * 3.90625000e-3;
  D[18] = S[9] * 94.9609375     + S[11] * 124.3125     + S[13] * 33.46875     + S[15] * 3.1875     + S[17] * 7.0312500e-2;
}

//////////////////////
// SwapT XZ @ order 9
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz9(iris_real *D, iris_real *S) {
  D[0] = S[0] * 3.90625000e-3 + S[2] * 3.90625000e-3 + S[4] * 3.90625000e-3 + S[6] * 3.90625000e-3 + S[8] * 3.90625000e-3;
  D[1] = S[1] * 6.2500e-2 + S[3] * 4.687500e-2 + S[5] * 3.12500e-2 + S[7] * 1.562500e-2;
  D[2] = S[0] * 0.59765625     + S[2] * 0.34765625     + S[4] * 0.16015625     + S[6] * 3.51562500e-2 + S[8] * -2.73437500e-2;
  D[3] = S[1] * 2.125     + S[3] * 0.71875     + S[5] * 6.2500e-2 + S[7] * -9.37500e-2;
  D[4] = S[0] * 11.953125     + S[2] * 3.203125     + S[4] * 0.140625     + S[6] * -0.234375     + S[8] * 7.812500e-2;
  D[5] = S[1] * 14.875     + S[3] * 0.65625     + S[5] * -0.5625     + S[7] * 0.21875    ;
  D[6] = S[0] * 72.515625     + S[2] * 4.265625     + S[4] * -1.421875     + S[6] * 0.453125     + S[8] * -0.109375    ;
  D[7] = S[1] * 27.625     + S[3] * -3.65625     + S[5] * 0.8125     + S[7] * -0.21875    ;
  D[8] = S[0] * 170.9296875     + S[2] * -7.8203125     + S[4] * 1.1171875     + S[6] * -0.2578125     + S[8] * 5.4687500e-2;
  D[9] = S[10] * 0.546875     + S[12] * -0.859375     + S[14] * 2.234375     + S[16] * -11.171875     + S[18] * 189.921875    ;
  D[10] = S[9] * 0.24609375     + S[11] * -0.6015625     + S[13] * 1.1171875     + S[15] * -3.3515625     + S[17] * 18.9921875    ;
  D[11] = S[10] * -0.4375     + S[12] * 0.5625     + S[14] * -0.8125     + S[16] * -0.8125     + S[18] * 124.3125    ;
  D[12] = S[9] * -0.1640625     + S[11] * 0.328125     + S[13] * -0.203125     + S[15] * -1.421875     + S[17] * 24.171875    ;
  D[13] = S[10] * 0.21875     + S[12] * -9.37500e-2 + S[14] * -0.65625     + S[16] * 5.03125     + S[18] * 33.46875    ;
  D[14] = S[9] * 7.0312500e-2 + S[11] * -7.812500e-2 + S[13] * -0.234375     + S[15] * 1.171875     + S[17] * 6.640625    ;
  D[15] = S[10] * -6.2500e-2 + S[12] * -6.2500e-2 + S[14] * 0.3125     + S[16] * 1.3125     + S[18] * 3.1875    ;
  D[16] = S[9] * -1.757812500e-2 + S[11] * -3.90625000e-3 + S[13] * 8.98437500e-2 + S[15] * 0.24609375     + S[17] * 0.46484375    ;
  D[17] = S[10] * 7.8125000e-3 + S[12] * 2.3437500e-2 + S[14] * 3.9062500e-2 + S[16] * 5.4687500e-2 + S[18] * 7.0312500e-2;
  D[18] = S[9] * 1.953125000e-3 + S[11] * 3.90625000e-3 + S[13] * 3.90625000e-3 + S[15] * 3.90625000e-3 + S[17] * 3.90625000e-3;
}

//////////////////////
// Swap XZ @ order 10
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swap_xz10(iris_real *D, iris_real *S) {
  D[0] = S[1] * 3.9062500e-2 + S[3] * 2.2265625     + S[5] * 30.28125     + S[7] * 151.40625     + S[9] * 328.046875    ;
  D[1] = S[0] * 1.953125000e-3 + S[2] * 0.296875     + S[4] * 5.677734375     + S[6] * 30.28125     + S[8] * 49.20703125    ;
  D[2] = S[1] * 3.12500e-2 + S[3] * 1.03125     + S[5] * 6.375     + S[7] * 6.375     + S[9] * -13.8125    ;
  D[3] = S[0] * 1.953125000e-3 + S[2] * 0.171875     + S[4] * 1.427734375     + S[6] * 0.53125     + S[8] * -6.04296875    ;
  D[4] = S[1] * 2.3437500e-2 + S[3] * 0.3359375     + S[5] * -3.12500e-2 + S[7] * -2.15625     + S[9] * 1.828125    ;
  D[5] = S[0] * 1.953125000e-3 + S[2] * 7.812500e-2 + S[4] * -9.765625000e-3 + S[6] * -0.78125     + S[8] * 1.26953125    ;
  D[6] = S[1] * 1.562500e-2 + S[3] * 1.562500e-2 + S[5] * -0.3125     + S[7] * 0.6875     + S[9] * -0.40625    ;
  D[7] = S[0] * 1.953125000e-3 + S[2] * 1.562500e-2 + S[4] * -0.134765625     + S[6] * 0.34375     + S[8] * -0.35546875    ;
  D[8] = S[1] * 7.8125000e-3 + S[3] * -5.4687500e-2 + S[5] * 0.15625     + S[7] * -0.21875     + S[9] * 0.109375    ;
  D[9] = S[0] * 1.953125000e-3 + S[2] * -1.562500e-2 + S[4] * 5.273437500e-2 + S[6] * -9.37500e-2 + S[8] * 8.20312500e-2;
  D[10] = S[10] * -0.24609375     + S[12] * 0.41015625     + S[14] * -0.234375     + S[16] * 8.789062500e-2 + S[18] * -1.95312500e-2 + S[20] * 1.953125000e-3;
  D[11] = S[11] * 0.4921875     + S[13] * -0.328125     + S[15] * 0.140625     + S[17] * -3.51562500e-2 + S[19] * 3.90625000e-3;
  D[12] = S[10] * 0.30078125     + S[12] * -0.46484375     + S[14] * 0.203125     + S[16] * -3.710937500e-2 + S[18] * -3.90625000e-3 + S[20] * 1.953125000e-3;
  D[13] = S[11] * -0.7109375     + S[13] * 0.328125     + S[15] * -1.562500e-2 + S[17] * -4.29687500e-2 + S[19] * 1.17187500e-2;
  D[14] = S[10] * -0.55859375     + S[12] * 0.66015625     + S[14] * 1.562500e-2 + S[16] * -0.162109375     + S[18] * 4.29687500e-2 + S[20] * 1.953125000e-3;
  D[15] = S[11] * 1.5234375     + S[13] * -7.812500e-2 + S[15] * -0.484375     + S[17] * 0.13671875     + S[19] * 1.95312500e-2;
  D[16] = S[10] * 1.67578125     + S[12] * -0.96484375     + S[14] * -1.296875     + S[16] * 0.462890625     + S[18] * 0.12109375     + S[20] * 1.953125000e-3;
  D[17] = S[11] * -5.1796875     + S[13] * -2.921875     + S[15] * 1.859375     + S[17] * 0.62890625     + S[19] * 2.73437500e-2;
  D[18] = S[10] * -9.49609375     + S[12] * -2.58984375     + S[14] * 8.765625     + S[16] * 3.087890625     + S[18] * 0.23046875     + S[20] * 1.953125000e-3;
  D[19] = S[11] * 32.8046875     + S[13] * 45.421875     + S[15] * 15.140625     + S[17] * 1.55859375     + S[19] * 3.51562500e-2;
  D[20] = S[10] * 180.42578125     + S[12] * 246.03515625     + S[14] * 75.703125     + S[16] * 9.462890625     + S[18] * 0.37109375     + S[20] * 1.953125000e-3;
}

//////////////////////
// SwapT XZ @ order 10
//////////////////////

IRIS_CUDA_DEVICE_HOST
void swapT_xz10(iris_real *D, iris_real *S) {
  D[0] = S[1] * 1.953125000e-3 + S[3] * 1.953125000e-3 + S[5] * 1.953125000e-3 + S[7] * 1.953125000e-3 + S[9] * 1.953125000e-3;
  D[1] = S[0] * 3.9062500e-2 + S[2] * 3.12500e-2 + S[4] * 2.3437500e-2 + S[6] * 1.562500e-2 + S[8] * 7.8125000e-3;
  D[2] = S[1] * 0.296875     + S[3] * 0.171875     + S[5] * 7.812500e-2 + S[7] * 1.562500e-2 + S[9] * -1.562500e-2;
  D[3] = S[0] * 2.2265625     + S[2] * 1.03125     + S[4] * 0.3359375     + S[6] * 1.562500e-2 + S[8] * -5.4687500e-2;
  D[4] = S[1] * 5.677734375     + S[3] * 1.427734375     + S[5] * -9.765625000e-3 + S[7] * -0.134765625     + S[9] * 5.273437500e-2;
  D[5] = S[0] * 30.28125     + S[2] * 6.375     + S[4] * -3.12500e-2 + S[6] * -0.3125     + S[8] * 0.15625    ;
  D[6] = S[1] * 30.28125     + S[3] * 0.53125     + S[5] * -0.78125     + S[7] * 0.34375     + S[9] * -9.37500e-2;
  D[7] = S[0] * 151.40625     + S[2] * 6.375     + S[4] * -2.15625     + S[6] * 0.6875     + S[8] * -0.21875    ;
  D[8] = S[1] * 49.20703125     + S[3] * -6.04296875     + S[5] * 1.26953125     + S[7] * -0.35546875     + S[9] * 8.20312500e-2;
  D[9] = S[0] * 328.046875     + S[2] * -13.8125     + S[4] * 1.828125     + S[6] * -0.40625     + S[8] * 0.109375    ;
  D[10] = S[10] * -0.24609375     + S[12] * 0.6015625     + S[14] * -1.1171875     + S[16] * 3.3515625     + S[18] * -18.9921875     + S[20] * 360.8515625    ;
  D[11] = S[11] * 0.4921875     + S[13] * -0.7109375     + S[15] * 1.5234375     + S[17] * -5.1796875     + S[19] * 32.8046875    ;
  D[12] = S[10] * 0.205078125     + S[12] * -0.46484375     + S[14] * 0.66015625     + S[16] * -0.96484375     + S[18] * -2.58984375     + S[20] * 246.03515625    ;
  D[13] = S[11] * -0.328125     + S[13] * 0.328125     + S[15] * -7.812500e-2 + S[17] * -2.921875     + S[19] * 45.421875    ;
  D[14] = S[10] * -0.1171875     + S[12] * 0.203125     + S[14] * 1.562500e-2 + S[16] * -1.296875     + S[18] * 8.765625     + S[20] * 75.703125    ;
  D[15] = S[11] * 0.140625     + S[13] * -1.562500e-2 + S[15] * -0.484375     + S[17] * 1.859375     + S[19] * 15.140625    ;
  D[16] = S[10] * 4.3945312500e-2 + S[12] * -3.710937500e-2 + S[14] * -0.162109375     + S[16] * 0.462890625     + S[18] * 3.087890625     + S[20] * 9.462890625    ;
  D[17] = S[11] * -3.51562500e-2 + S[13] * -4.29687500e-2 + S[15] * 0.13671875     + S[17] * 0.62890625     + S[19] * 1.55859375    ;
  D[18] = S[10] * -9.765625000e-3 + S[12] * -3.90625000e-3 + S[14] * 4.29687500e-2 + S[16] * 0.12109375     + S[18] * 0.23046875     + S[20] * 0.37109375    ;
  D[19] = S[11] * 3.90625000e-3 + S[13] * 1.17187500e-2 + S[15] * 1.95312500e-2 + S[17] * 2.73437500e-2 + S[19] * 3.51562500e-2;
  D[20] = S[10] * 9.7656250000e-4 + S[12] * 1.953125000e-3 + S[14] * 1.953125000e-3 + S[16] * 1.953125000e-3 + S[18] * 1.953125000e-3 + S[20] * 1.953125000e-3;
}

//---------------8<---------------8<----------------8<---------------
// END OF AUTOMATICALLY GENERATED BLOCK


swap_fn swapT_fns[] = {
		       swapT_xz1, swapT_xz2, swapT_xz3, swapT_xz4,
		       swapT_xz5, swapT_xz6, swapT_xz7, swapT_xz8,
		       swapT_xz9, swapT_xz10
};

swap_fn swap_fns[] = {
		      swap_xz1, swap_xz2, swap_xz3, swap_xz4,
		      swap_xz5, swap_xz6, swap_xz7, swap_xz8,
		      swap_xz9, swap_xz10
};


#ifdef IRIS_CUDA
IRIS_CUDA_DEVICE swap_fn d_swapT_fns[] = {
		       swapT_xz1, swapT_xz2, swapT_xz3, swapT_xz4,
		       swapT_xz5, swapT_xz6, swapT_xz7, swapT_xz8,
		       swapT_xz9, swapT_xz10
};

IRIS_CUDA_DEVICE swap_fn d_swap_fns[] = {
		      swap_xz1, swap_xz2, swap_xz3, swap_xz4,
		      swap_xz5, swap_xz6, swap_xz7, swap_xz8,
		      swap_xz9, swap_xz10
};
#endif
